function cov_28sp1tlphb(){var path="/home/bahati/html/my-brand/node-mongo-tutorial/middlewares/AuthMiddleware.js";var hash="fb79f6273656bc3b205a696d38e0ce9345b1d009";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/bahati/html/my-brand/node-mongo-tutorial/middlewares/AuthMiddleware.js",statementMap:{"0":{start:{line:1,column:12},end:{line:1,column:35}},"1":{start:{line:4,column:8},end:{line:20,column:9}},"2":{start:{line:6,column:26},end:{line:6,column:68}},"3":{start:{line:7,column:12},end:{line:7,column:36}},"4":{start:{line:8,column:12},end:{line:10,column:13}},"5":{start:{line:9,column:16},end:{line:9,column:71}},"6":{start:{line:11,column:25},end:{line:11,column:68}},"7":{start:{line:12,column:12},end:{line:14,column:13}},"8":{start:{line:13,column:16},end:{line:13,column:86}},"9":{start:{line:15,column:12},end:{line:15,column:29}},"10":{start:{line:16,column:12},end:{line:16,column:18}},"11":{start:{line:19,column:12},end:{line:19,column:87}},"12":{start:{line:25,column:0},end:{line:25,column:32}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:3,column:4},end:{line:3,column:5}},loc:{start:{line:3,column:59},end:{line:21,column:5}},line:3}},branchMap:{"0":{loc:{start:{line:8,column:12},end:{line:10,column:13}},type:"if",locations:[{start:{line:8,column:12},end:{line:10,column:13}},{start:{line:8,column:12},end:{line:10,column:13}}],line:8},"1":{loc:{start:{line:12,column:12},end:{line:14,column:13}},type:"if",locations:[{start:{line:12,column:12},end:{line:14,column:13}},{start:{line:12,column:12},end:{line:14,column:13}}],line:12}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},f:{"0":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"fb79f6273656bc3b205a696d38e0ce9345b1d009"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_28sp1tlphb=function(){return actualCoverage;};}return actualCoverage;}cov_28sp1tlphb();const jwt=(cov_28sp1tlphb().s[0]++,require("jsonwebtoken"));class AuthMiddleware{static async checkAuthenticationStatus(req,res,next){cov_28sp1tlphb().f[0]++;cov_28sp1tlphb().s[1]++;try{const token=(cov_28sp1tlphb().s[2]++,req.headers["authorization"].split(" ")[1]);cov_28sp1tlphb().s[3]++;console.log(req.headers);cov_28sp1tlphb().s[4]++;if(!token){cov_28sp1tlphb().b[0][0]++;cov_28sp1tlphb().s[5]++;return res.status(400).json({msg:"Please sign in!"});}else{cov_28sp1tlphb().b[0][1]++;}const data=(cov_28sp1tlphb().s[6]++,jwt.verify(token,process.env.TOKEN_SECRET));cov_28sp1tlphb().s[7]++;if(!data){cov_28sp1tlphb().b[1][0]++;cov_28sp1tlphb().s[8]++;return res.status(400).json({msg:"Invalid token, Please sign in!"});}else{cov_28sp1tlphb().b[1][1]++;}cov_28sp1tlphb().s[9]++;req.id=data.id;cov_28sp1tlphb().s[10]++;next();}catch(error){cov_28sp1tlphb().s[11]++;return res.status(500).json({msg:"Something went wrong, Invalid token"});}}}cov_28sp1tlphb().s[12]++;module.exports=AuthMiddleware;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqd3QiLCJyZXF1aXJlIiwiQXV0aE1pZGRsZXdhcmUiLCJjaGVja0F1dGhlbnRpY2F0aW9uU3RhdHVzIiwicmVxIiwicmVzIiwibmV4dCIsInRva2VuIiwiaGVhZGVycyIsInNwbGl0IiwiY29uc29sZSIsImxvZyIsInN0YXR1cyIsImpzb24iLCJtc2ciLCJkYXRhIiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIlRPS0VOX1NFQ1JFVCIsImlkIiwiZXJyb3IiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiQXV0aE1pZGRsZXdhcmUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgand0ID0gcmVxdWlyZShcImpzb253ZWJ0b2tlblwiKTtcbmNsYXNzIEF1dGhNaWRkbGV3YXJlIHtcbiAgICBzdGF0aWMgYXN5bmMgY2hlY2tBdXRoZW50aWNhdGlvblN0YXR1cyhyZXEsIHJlcywgbmV4dCkge1xuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICBjb25zdCB0b2tlbiA9IHJlcS5oZWFkZXJzW1wiYXV0aG9yaXphdGlvblwiXS5zcGxpdChcIiBcIilbMV07XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXEuaGVhZGVycylcbiAgICAgICAgICAgIGlmICghdG9rZW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtc2c6IFwiUGxlYXNlIHNpZ24gaW4hXCIgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5UT0tFTl9TRUNSRVQpO1xuICAgICAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbXNnOiBcIkludmFsaWQgdG9rZW4sIFBsZWFzZSBzaWduIGluIVwiIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXEuaWQgPSBkYXRhLmlkO1xuICAgICAgICAgICAgbmV4dCgpXG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1zZzogXCJTb21ldGhpbmcgd2VudCB3cm9uZywgSW52YWxpZCB0b2tlblwiIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBBdXRoTWlkZGxld2FyZTsiXSwibWFwcGluZ3MiOiI0OERBZVk7QUFBQSwyRkFmWixLQUFNQSxJQUFHLDBCQUFHQyxPQUFPLENBQUMsY0FBYyxDQUFDLEVBQ25DLEtBQU1DLGVBQWUsQ0FDakIsWUFBYUMsMEJBQXlCLENBQUNDLEdBQUcsQ0FBRUMsR0FBRyxDQUFFQyxJQUFJLENBQUUsaURBQ25ELEdBQUksQ0FFQSxLQUFNQyxNQUFLLDBCQUFHSCxHQUFHLENBQUNJLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQ0MsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFDLHdCQUN6REMsT0FBTyxDQUFDQyxHQUFHLENBQUNQLEdBQUcsQ0FBQ0ksT0FBTyxDQUFDLHlCQUN4QixHQUFJLENBQUNELEtBQUssQ0FBRSxvREFDUixNQUFPRixJQUFHLENBQUNPLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUVDLEdBQUcsQ0FBRSxpQkFBa0IsQ0FBQyxDQUFDLENBQzNELENBQUMsaUNBQ0QsS0FBTUMsS0FBSSwwQkFBR2YsR0FBRyxDQUFDZ0IsTUFBTSxDQUFDVCxLQUFLLENBQUVVLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxZQUFZLENBQUMsRUFBQyx3QkFDekQsR0FBSSxDQUFDSixJQUFJLENBQUUsb0RBQ1AsTUFBT1YsSUFBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxDQUFFQyxHQUFHLENBQUUsZ0NBQWlDLENBQUMsQ0FBQyxDQUMxRSxDQUFDLHlEQUNEVixHQUFHLENBQUNnQixFQUFFLENBQUdMLElBQUksQ0FBQ0ssRUFBRSxDQUFDLHlCQUNqQmQsSUFBSSxFQUFFLENBRVYsQ0FBRSxNQUFPZSxLQUFLLENBQUUsMEJBQ1osTUFBT2hCLElBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBRUMsR0FBRyxDQUFFLHFDQUFzQyxDQUFDLENBQUMsQ0FDL0UsQ0FDSixDQUVKLENBQUMseUJBRURRLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHckIsY0FBYyJ9