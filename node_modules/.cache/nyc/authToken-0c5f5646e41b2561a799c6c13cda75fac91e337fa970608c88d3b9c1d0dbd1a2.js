function cov_i7rt3snxx(){var path="/home/bahati/html/my-brand/node-mongo-tutorial/middlewares/authToken.js";var hash="24e4acc16bd0a40e8c49d0535476a325454369b7";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/bahati/html/my-brand/node-mongo-tutorial/middlewares/authToken.js",statementMap:{"0":{start:{line:1,column:12},end:{line:1,column:35}},"1":{start:{line:4,column:8},end:{line:19,column:9}},"2":{start:{line:5,column:26},end:{line:5,column:68}},"3":{start:{line:6,column:12},end:{line:6,column:36}},"4":{start:{line:7,column:12},end:{line:9,column:13}},"5":{start:{line:8,column:16},end:{line:8,column:71}},"6":{start:{line:10,column:25},end:{line:10,column:69}},"7":{start:{line:11,column:12},end:{line:13,column:13}},"8":{start:{line:12,column:16},end:{line:12,column:86}},"9":{start:{line:14,column:12},end:{line:14,column:29}},"10":{start:{line:15,column:12},end:{line:15,column:18}},"11":{start:{line:18,column:12},end:{line:18,column:87}},"12":{start:{line:24,column:0},end:{line:24,column:38}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:3,column:4},end:{line:3,column:5}},loc:{start:{line:3,column:53},end:{line:20,column:5}},line:3}},branchMap:{"0":{loc:{start:{line:7,column:12},end:{line:9,column:13}},type:"if",locations:[{start:{line:7,column:12},end:{line:9,column:13}},{start:{line:7,column:12},end:{line:9,column:13}}],line:7},"1":{loc:{start:{line:11,column:12},end:{line:13,column:13}},type:"if",locations:[{start:{line:11,column:12},end:{line:13,column:13}},{start:{line:11,column:12},end:{line:13,column:13}}],line:11}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},f:{"0":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"24e4acc16bd0a40e8c49d0535476a325454369b7"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_i7rt3snxx=function(){return actualCoverage;};}return actualCoverage;}cov_i7rt3snxx();const jwt=(cov_i7rt3snxx().s[0]++,require("jsonwebtoken"));class PublicAuthMiddleware{static async checkAuthentication(req,res,next){cov_i7rt3snxx().f[0]++;cov_i7rt3snxx().s[1]++;try{const token=(cov_i7rt3snxx().s[2]++,req.headers["authorization"].split(" ")[1]);cov_i7rt3snxx().s[3]++;console.log(req.headers);cov_i7rt3snxx().s[4]++;if(!token){cov_i7rt3snxx().b[0][0]++;cov_i7rt3snxx().s[5]++;return res.status(400).json({msg:"Please sign in!"});}else{cov_i7rt3snxx().b[0][1]++;}const data=(cov_i7rt3snxx().s[6]++,jwt.verify(token,process.env.PUBLIC_SECRET));cov_i7rt3snxx().s[7]++;if(!data){cov_i7rt3snxx().b[1][0]++;cov_i7rt3snxx().s[8]++;return res.status(400).json({msg:"Invalid token, Please sign in!"});}else{cov_i7rt3snxx().b[1][1]++;}cov_i7rt3snxx().s[9]++;req.id=data.id;cov_i7rt3snxx().s[10]++;next();}catch(error){cov_i7rt3snxx().s[11]++;return res.status(500).json({msg:"Something went wrong, Invalid token"});}}}cov_i7rt3snxx().s[12]++;module.exports=PublicAuthMiddleware;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqd3QiLCJyZXF1aXJlIiwiUHVibGljQXV0aE1pZGRsZXdhcmUiLCJjaGVja0F1dGhlbnRpY2F0aW9uIiwicmVxIiwicmVzIiwibmV4dCIsInRva2VuIiwiaGVhZGVycyIsInNwbGl0IiwiY29uc29sZSIsImxvZyIsInN0YXR1cyIsImpzb24iLCJtc2ciLCJkYXRhIiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIlBVQkxJQ19TRUNSRVQiLCJpZCIsImVycm9yIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImF1dGhUb2tlbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBqd3QgPSByZXF1aXJlKFwianNvbndlYnRva2VuXCIpO1xuY2xhc3MgUHVibGljQXV0aE1pZGRsZXdhcmUge1xuICAgIHN0YXRpYyBhc3luYyBjaGVja0F1dGhlbnRpY2F0aW9uKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB0b2tlbiA9IHJlcS5oZWFkZXJzW1wiYXV0aG9yaXphdGlvblwiXS5zcGxpdChcIiBcIilbMV07XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXEuaGVhZGVycylcbiAgICAgICAgICAgIGlmICghdG9rZW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtc2c6IFwiUGxlYXNlIHNpZ24gaW4hXCIgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5QVUJMSUNfU0VDUkVUKTtcbiAgICAgICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1zZzogXCJJbnZhbGlkIHRva2VuLCBQbGVhc2Ugc2lnbiBpbiFcIiB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVxLmlkID0gZGF0YS5pZDtcbiAgICAgICAgICAgIG5leHQoKVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtc2c6IFwiU29tZXRoaW5nIHdlbnQgd3JvbmcsIEludmFsaWQgdG9rZW5cIiB9KVxuICAgICAgICB9XG4gICAgfVxuXG59XG5cbm1vZHVsZS5leHBvcnRzID0gUHVibGljQXV0aE1pZGRsZXdhcmU7Il0sIm1hcHBpbmdzIjoiNjdEQWVZO0FBQUEseUZBZlosS0FBTUEsSUFBRyx5QkFBR0MsT0FBTyxDQUFDLGNBQWMsQ0FBQyxFQUNuQyxLQUFNQyxxQkFBcUIsQ0FDdkIsWUFBYUMsb0JBQW1CLENBQUNDLEdBQUcsQ0FBRUMsR0FBRyxDQUFFQyxJQUFJLENBQUUsK0NBQzdDLEdBQUksQ0FDQSxLQUFNQyxNQUFLLHlCQUFHSCxHQUFHLENBQUNJLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQ0MsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFDLHVCQUN6REMsT0FBTyxDQUFDQyxHQUFHLENBQUNQLEdBQUcsQ0FBQ0ksT0FBTyxDQUFDLHdCQUN4QixHQUFJLENBQUNELEtBQUssQ0FBRSxrREFDUixNQUFPRixJQUFHLENBQUNPLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUVDLEdBQUcsQ0FBRSxpQkFBa0IsQ0FBQyxDQUFDLENBQzNELENBQUMsZ0NBQ0QsS0FBTUMsS0FBSSx5QkFBR2YsR0FBRyxDQUFDZ0IsTUFBTSxDQUFDVCxLQUFLLENBQUVVLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxhQUFhLENBQUMsRUFBQyx1QkFDMUQsR0FBSSxDQUFDSixJQUFJLENBQUUsa0RBQ1AsTUFBT1YsSUFBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxDQUFFQyxHQUFHLENBQUUsZ0NBQWlDLENBQUMsQ0FBQyxDQUMxRSxDQUFDLHVEQUNEVixHQUFHLENBQUNnQixFQUFFLENBQUdMLElBQUksQ0FBQ0ssRUFBRSxDQUFDLHdCQUNqQmQsSUFBSSxFQUFFLENBRVYsQ0FBRSxNQUFPZSxLQUFLLENBQUUseUJBQ1osTUFBT2hCLElBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBRUMsR0FBRyxDQUFFLHFDQUFzQyxDQUFDLENBQUMsQ0FDL0UsQ0FDSixDQUVKLENBQUMsd0JBRURRLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHckIsb0JBQW9CIn0=