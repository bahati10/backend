function cov_1lrlcxnl18(){var path="/home/bahati/html/my-brand/node-mongo-tutorial/controllers/publicController.js";var hash="8f98ae3aac85b32d38f1bcbdfdc8e4713a47eac9";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/bahati/html/my-brand/node-mongo-tutorial/controllers/publicController.js",statementMap:{"0":{start:{line:1,column:15},end:{line:1,column:32}},"1":{start:{line:2,column:14},end:{line:2,column:39}},"2":{start:{line:3,column:12},end:{line:3,column:35}},"3":{start:{line:7,column:8},end:{line:29,column:9}},"4":{start:{line:8,column:40},end:{line:8,column:48}},"5":{start:{line:9,column:12},end:{line:11,column:13}},"6":{start:{line:10,column:16},end:{line:10,column:97}},"7":{start:{line:13,column:30},end:{line:13,column:58}},"8":{start:{line:15,column:12},end:{line:17,column:13}},"9":{start:{line:16,column:16},end:{line:16,column:85}},"10":{start:{line:19,column:28},end:{line:19,column:78}},"11":{start:{line:20,column:12},end:{line:22,column:13}},"12":{start:{line:21,column:16},end:{line:21,column:71}},"13":{start:{line:24,column:26},end:{line:24,column:96}},"14":{start:{line:25,column:12},end:{line:25,column:80}},"15":{start:{line:28,column:12},end:{line:28,column:35}},"16":{start:{line:33,column:0},end:{line:33,column:34}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:4},end:{line:6,column:5}},loc:{start:{line:6,column:39},end:{line:30,column:5}},line:6}},branchMap:{"0":{loc:{start:{line:9,column:12},end:{line:11,column:13}},type:"if",locations:[{start:{line:9,column:12},end:{line:11,column:13}},{start:{line:9,column:12},end:{line:11,column:13}}],line:9},"1":{loc:{start:{line:9,column:16},end:{line:9,column:35}},type:"binary-expr",locations:[{start:{line:9,column:16},end:{line:9,column:22}},{start:{line:9,column:26},end:{line:9,column:35}}],line:9},"2":{loc:{start:{line:15,column:12},end:{line:17,column:13}},type:"if",locations:[{start:{line:15,column:12},end:{line:17,column:13}},{start:{line:15,column:12},end:{line:17,column:13}}],line:15},"3":{loc:{start:{line:20,column:12},end:{line:22,column:13}},type:"if",locations:[{start:{line:20,column:12},end:{line:22,column:13}},{start:{line:20,column:12},end:{line:22,column:13}}],line:20}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},f:{"0":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"8f98ae3aac85b32d38f1bcbdfdc8e4713a47eac9"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1lrlcxnl18=function(){return actualCoverage;};}return actualCoverage;}cov_1lrlcxnl18();const bcrypt=(cov_1lrlcxnl18().s[0]++,require("bcrypt"));const User=(cov_1lrlcxnl18().s[1]++,require("../models/User"));const jwt=(cov_1lrlcxnl18().s[2]++,require("jsonwebtoken"));class PublicController{static async PublicLogin(req,res){cov_1lrlcxnl18().f[0]++;cov_1lrlcxnl18().s[3]++;try{const{email,password}=(cov_1lrlcxnl18().s[4]++,req.body);cov_1lrlcxnl18().s[5]++;if((cov_1lrlcxnl18().b[1][0]++,!email)||(cov_1lrlcxnl18().b[1][1]++,!password)){cov_1lrlcxnl18().b[0][0]++;cov_1lrlcxnl18().s[6]++;return res.status(400).json({msg:"Please add all required inputs",error:""});}else{cov_1lrlcxnl18().b[0][1]++;}const doesExist=(cov_1lrlcxnl18().s[7]++,await User.findOne({email}));cov_1lrlcxnl18().s[8]++;if(!doesExist){cov_1lrlcxnl18().b[2][0]++;cov_1lrlcxnl18().s[9]++;return res.status(400).json({msg:"User doesn't exist",error:""});}else{cov_1lrlcxnl18().b[2][1]++;}const isValid=(cov_1lrlcxnl18().s[10]++,await bcrypt.compare(password,doesExist.password));cov_1lrlcxnl18().s[11]++;if(!isValid){cov_1lrlcxnl18().b[3][0]++;cov_1lrlcxnl18().s[12]++;return res.status(400).json({error:"Invalid password"});}else{cov_1lrlcxnl18().b[3][1]++;}const token=(cov_1lrlcxnl18().s[13]++,jwt.sign({id:User.id},process.env.PUBLIC_SECRET,{expiresIn:3600}));cov_1lrlcxnl18().s[14]++;return res.status(200).json({msg:"Logged in succesfully",token});}catch(error){cov_1lrlcxnl18().s[15]++;throw new Error(error);}}}cov_1lrlcxnl18().s[16]++;module.exports=PublicController;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJiY3J5cHQiLCJyZXF1aXJlIiwiVXNlciIsImp3dCIsIlB1YmxpY0NvbnRyb2xsZXIiLCJQdWJsaWNMb2dpbiIsInJlcSIsInJlcyIsImVtYWlsIiwicGFzc3dvcmQiLCJib2R5Iiwic3RhdHVzIiwianNvbiIsIm1zZyIsImVycm9yIiwiZG9lc0V4aXN0IiwiZmluZE9uZSIsImlzVmFsaWQiLCJjb21wYXJlIiwidG9rZW4iLCJzaWduIiwiaWQiLCJwcm9jZXNzIiwiZW52IiwiUFVCTElDX1NFQ1JFVCIsImV4cGlyZXNJbiIsIkVycm9yIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInB1YmxpY0NvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgYmNyeXB0ID0gcmVxdWlyZShcImJjcnlwdFwiKTtcbmNvbnN0IFVzZXIgID0gcmVxdWlyZShcIi4uL21vZGVscy9Vc2VyXCIpO1xuY29uc3Qgand0ID0gcmVxdWlyZShcImpzb253ZWJ0b2tlblwiKTtcblxuY2xhc3MgUHVibGljQ29udHJvbGxlciB7XG4gICAgc3RhdGljIGFzeW5jIFB1YmxpY0xvZ2luKHJlcSwgcmVzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCB9ID0gcmVxLmJvZHk7XG4gICAgICAgICAgICBpZiAoIWVtYWlsIHx8ICFwYXNzd29yZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1zZzogXCJQbGVhc2UgYWRkIGFsbCByZXF1aXJlZCBpbnB1dHNcIiwgZXJyb3I6IFwiXCIgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgZG9lc0V4aXN0ID0gYXdhaXQgIFVzZXIuZmluZE9uZSh7ZW1haWx9KTtcblxuICAgICAgICAgICAgaWYgKCFkb2VzRXhpc3QpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtc2c6IFwiVXNlciBkb2Vzbid0IGV4aXN0XCIsIGVycm9yOiBcIlwiIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgZG9lc0V4aXN0LnBhc3N3b3JkKTtcbiAgICAgICAgICAgIGlmKCFpc1ZhbGlkKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe2Vycm9yOlwiSW52YWxpZCBwYXNzd29yZFwifSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgICBjb25zdCB0b2tlbiA9IGp3dC5zaWduKHsgaWQ6IFVzZXIuaWQgfSwgcHJvY2Vzcy5lbnYuUFVCTElDX1NFQ1JFVCx7ZXhwaXJlc0luOiAzNjAwfSlcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1zZzogXCJMb2dnZWQgaW4gc3VjY2VzZnVsbHlcIiwgdG9rZW4gfSlcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBQdWJsaWNDb250cm9sbGVyOyJdLCJtYXBwaW5ncyI6IjhtRkFlWTtBQUFBLDJGQWZaLEtBQU1BLE9BQU0sMEJBQUdDLE9BQU8sQ0FBQyxRQUFRLENBQUMsRUFDaEMsS0FBTUMsS0FBSSwwQkFBSUQsT0FBTyxDQUFDLGdCQUFnQixDQUFDLEVBQ3ZDLEtBQU1FLElBQUcsMEJBQUdGLE9BQU8sQ0FBQyxjQUFjLENBQUMsRUFFbkMsS0FBTUcsaUJBQWlCLENBQ25CLFlBQWFDLFlBQVcsQ0FBQ0MsR0FBRyxDQUFFQyxHQUFHLENBQUUsaURBQy9CLEdBQUksQ0FDQSxLQUFNLENBQUVDLEtBQUssQ0FBRUMsUUFBUyxDQUFDLDBCQUFHSCxHQUFHLENBQUNJLElBQUksRUFBQyx3QkFDckMsR0FBSSw2QkFBQ0YsS0FBSywrQkFBSSxDQUFDQyxRQUFRLEVBQUUsb0RBQ3JCLE1BQU9GLElBQUcsQ0FBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBRUMsR0FBRyxDQUFFLGdDQUFnQyxDQUFFQyxLQUFLLENBQUUsRUFBRyxDQUFDLENBQUMsQ0FDckYsQ0FBQyxpQ0FFRCxLQUFNQyxVQUFTLDBCQUFHLEtBQU9iLEtBQUksQ0FBQ2MsT0FBTyxDQUFDLENBQUNSLEtBQUssQ0FBQyxDQUFDLEVBQUMsd0JBRS9DLEdBQUksQ0FBQ08sU0FBUyxDQUFFLG9EQUNaLE1BQU9SLElBQUcsQ0FBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBRUMsR0FBRyxDQUFFLG9CQUFvQixDQUFFQyxLQUFLLENBQUUsRUFBRyxDQUFDLENBQUMsQ0FDekUsQ0FBQyxpQ0FFRCxLQUFNRyxRQUFPLDJCQUFHLEtBQU1qQixPQUFNLENBQUNrQixPQUFPLENBQUNULFFBQVEsQ0FBRU0sU0FBUyxDQUFDTixRQUFRLENBQUMsRUFBQyx5QkFDbkUsR0FBRyxDQUFDUSxPQUFPLENBQUMscURBQ1IsTUFBT1YsSUFBRyxDQUFDSSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxDQUFDRSxLQUFLLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUMzRCxDQUFDLGlDQUVELEtBQU1LLE1BQUssMkJBQUdoQixHQUFHLENBQUNpQixJQUFJLENBQUMsQ0FBRUMsRUFBRSxDQUFFbkIsSUFBSSxDQUFDbUIsRUFBRyxDQUFDLENBQUVDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxhQUFhLENBQUMsQ0FBQ0MsU0FBUyxDQUFFLElBQUksQ0FBQyxDQUFDLDJCQUNwRixNQUFPbEIsSUFBRyxDQUFDSSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxDQUFFQyxHQUFHLENBQUUsdUJBQXVCLENBQUVNLEtBQU0sQ0FBQyxDQUFDLENBRXhFLENBQUUsTUFBT0wsS0FBSyxDQUFFLDBCQUNaLEtBQU0sSUFBSVksTUFBSyxDQUFDWixLQUFLLENBQUMsQ0FDMUIsQ0FDSixDQUNKLENBQUMseUJBRURhLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHeEIsZ0JBQWdCIn0=